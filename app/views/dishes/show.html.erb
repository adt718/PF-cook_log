<% provide(:title, "#{@dish.name}") %>
<% @comments  = @dish.feed_comment(@dish.id) %>
<% @logs  = @dish.feed_log(@dish.id) %>
  <div class="container">
    <div class="row">
      <div class="col-md-4">
        <span class="picture">
          <%= link_to((image_tag @dish.picture.thumb400.url), dish_path(@dish.id), class: 'dish-picture') if @dish.picture.url.present? %>
        </span>
        <%= render 'users/favorite_form' %>
        <%= render 'users/list_form' %>
      </div>
      <div class="col-md-8">
        <h2 class="dish-name"><%= @dish.name %></h2>
        <div class="change-dish">
          <% if current_user == @dish.user %>
            <%= link_to "編集", edit_dish_path(@dish), class: 'edit-dish' %>
          <% end %>
          <% if current_user.admin? || (current_user == @dish.user) %>
            <%= link_to "削除", dish_path(@dish), method: :delete, class: 'delete-dish',
                                          data: { confirm: "本当に削除しますか？" } %>
          <% end %>
        </div>
        <h4><%= @dish.description %></h4>
        <h4 class="dish-reference">作り方：<%= link_to "#{@dish.reference}", @dish.reference, target: "_blank" %></h4>
         <div class="ingredients">
          <h5 class="title-ingredients">材料</h5>
          <div class="row">
            <div class="col-md-8">
              <table class="ingredient">
                <% @dish.ingredients.each do |i| %>
                  <% if i.name.present? %>
                    <tr>
                      <td><%= i.name %></td>
                      <td><%= i.quantity %></td>
                    </tr>
                  <% end %>
                <% end %>
              </table>
            </div>
          </div>
        </div>
        <div class="tips">
          <h5 class="title-tips">コツ・ポイント</h5>
          <h5><%= @dish.tips %></h5>
        </div>
        <div class="dish-info">
          <h5>分量：</h5><h4><%= @dish.portion %></h4> <h5>人分</h5>
        </div>
        <div class="show-dish-other-info">
          <div class="dish-info">
            <h5>作った回数：</h5><h4><%= @dish.logs.count %></h4> <h5>回</h5>
          </div>
          <div class="dish-info">
            <h5>所要時間：</h5><h4><%= @dish.required_time %></h4> <h5>分</h5>
          </div>
          <div class="dish-info">
            <h5>人気度：</h5>
            <h4>
              <% if @dish.popularity.present? %>
                <%= "★" * @dish.popularity %><%= "☆" * (5 - @dish.popularity) %>
              <% end %>
            </h4>
          </div>
        </div>
        <% if current_user == @dish.user %>
          <div class="log">
            <%= render "logs/feed_logs" %>
           <%= form_for(@log) do |f| %>
  <%= hidden_field_tag :dish_id, @dish.id %>
  <div class="row">
    <div class="col-md-8 col-md-offset-1">
      <div class="field">
        <%= f.text_area :content, placeholder: "クックメモ" , :size => "50*30" %>
      </div>
    </div>
    <div class="col-md-3">
      <%= f.submit "ログ追加", class: "btn btn-square-shadow" %>
    </div>
  </div>
<% end %>
  <%= form_for(Log.new) do |f| %>
  <%= hidden_field_tag :dish_id, @dish.id %>
  <%= hidden_field_tag :list_id, @list.id if @list.present? %>
  <p class="add-cooklog"><i class="fas fa-utensils"></i> クックログを追加する</p>
  <div class="row">
    <div class="col-md-9">
      <div class="field">
        <%= f.text_area :content, placeholder: "クックメモ", :size => "50*30" %>
      </div>
    </div>
    <div class="col-md-3">
      <% if @list.present? %>
        <%= f.submit "追加", class: "btn btn-square-shadow",
                                      data: { confirm: "クックログを追加し、リストから削除しますか？" } %>
      <% else %>
        <%= f.submit "追加", class: "btn btn-square-shadow" %>
      <% end %>
    </div>
  </div>
  <% end %>
          </div>
        <% end %>
        <div class="comment">
          <%= render "comments/feed_comments" %>
          <%= render "comments/new" %>
        </div>
      </div>
    </div>
  </div>
